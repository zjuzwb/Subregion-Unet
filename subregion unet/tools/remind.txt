from https://github.com/meetps/pytorch-semseg/blob/master/ptsemseg/metrics.py